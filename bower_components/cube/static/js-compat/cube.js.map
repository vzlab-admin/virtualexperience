{"version":3,"sources":["../js/cube.js"],"names":["$","document","ready","mouseCubeDown","body","onmousedown","onmouseup","CubeManager","enabled","cubeName","cubeContainer","setCubeName","css","setActive","restartCube","intialRotation","rotation3d","y","x","isActive","cubeManager","window","container","rotationContainer","mousePosition","z","startingOrientation","velocity","lastPosition","printTime","realOrientation","lastGamma","lastX","lastY","getElementById","addEventListener","deviceMotionListener","doOnOrientationChange","onmousemove","handleMouseMove","orientation","event","gamma","deltaX","deltaY","pageX","pageY","verticalY","Math","abs","alpha","beta","newY","lastTouchX","lastTouchY","xShift","yShift","e","changedTouches","refresh","smooth","newX","isie","newOrientation","width","tourManager","setIePosition","setInterval"],"mappings":"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","file":"cube.js","sourcesContent":["\n$(document).ready(function() {\n\tvar mouseCubeDown = 0;\n\tdocument.body.onmousedown = function() {\n\t  mouseCubeDown=1;\n\t}\n\tdocument.body.onmouseup = function() {\n\t  mouseCubeDown=0;\n\t}\n    \n\tvar CubeManager = function(){\n\t\tthis.enabled = false;\n\t\tthis.cubeName=null;\n\t\tthis.cubeContainer=null\n\t\tthis.setCubeName = function(cubeName){\n\t\t\t$('#'+this.cubeName).css('display','none');\n\t\t\tthis.cubeName = cubeName;\n\t\t\t$('#'+this.cubeName).css('display','inline');\n\t\t}\n\t\tthis.setActive = function(enabled){\n\t\t\tif(!enabled){\n\t\t\t\t$('#'+this.cubeName).css('display','none');\n\t\t\t\tthis.cubeName = null;\n\t\t\t}else{\n\t\t\t\tthis.restartCube();\n\t\t\t}\n\t\t\tthis.enabled = enabled;\n\t\t}\n\t\tthis.restartCube = function(){\n\t\t\tintialRotation = rotation3d.y;\n\t\t\trotation3d.x = 0;\n\t\t}\n\t\tthis.isActive = function(){\n\t\t\treturn this.enabled;\n\t\t}\n\t}\n\n\tvar cubeManager = new CubeManager();\n\twindow.cubeManager = cubeManager;\n\t//cubeManager.setCubeName('saveiro_aventura_interno');\n\t//cubeManager.setActive(true);\n\tvar container;\n\tvar rotationContainer;\n\tvar mousePosition = {x:500, y:500};\n\tvar rotation3d = {x:0, y:0, z:0};\n\tvar startingOrientation;\n\tvar velocity = 0.25;\n\tvar lastPosition = null;\n\tvar printTime = 0;\n\tvar realOrientation = null;\n\tvar lastGamma = null;\n\tvar intialRotation = null;\n\tvar lastX = null;\n\tvar lastY = null;\n    container = document.getElementById(\"tour_interno\");\n    rotationContainer = document.getElementById(\"rotationContainer\");\n    window.addEventListener(\"deviceorientation\", deviceMotionListener);\n    window.addEventListener('orientationchange', doOnOrientationChange);\n\twindow.onmousemove = handleMouseMove;\n\n    function doOnOrientationChange(){\n\t\trealOrientation = window.orientation;\n\t\tlastGamma = event.gamma;\n\t}\n\n\tfunction handleMouseMove(event) {\n\t\tevent = event || window.event; // IE-ism\n\t\tvar deltaX,deltaY;\n\t\tif(mouseCubeDown){\n\t\t\tif(lastPosition){\n\t\t\t\tdeltaX = event.pageX - lastPosition.pageX;\n\t\t\t\tdeltaY = event.pageY - lastPosition.pageY;\n\t\t\t\trotation3d.y += velocity*deltaX;\n\t\t\t\trotation3d.x -= velocity*deltaY;\n\t\t\t}\n\t\t}\n\n\t\tif(rotation3d.x > 45) rotation3d.x = 45;\n\t\tif(rotation3d.x < -45) rotation3d.x = -45;\n\t\tlastPosition = event;\n\t}\n\tvar verticalY = null;\n\tfunction deviceMotionListener(event){\n\t    if(realOrientation == null){realOrientation = window.orientation;}\n\t    if(lastGamma == null){lastGamma = event.gamma;}\n\n\t    if(Math.abs(event.gamma) < 10){\n\t\t\tif(lastGamma*event.gamma<0){\n\t\t\t\trealOrientation = -realOrientation;\n\t\t\t\tlastGamma = event.gamma;\n\t\t\t}\n\t    }else{\n\t    \tif(lastGamma*event.gamma<0){\n\t\t\t\tlastGamma = event.gamma;\n\t\t\t}\n\t    }\n\t    if(event.alpha != null){\n\t    \tif(realOrientation == 90){\n\t\t    \tif(event.gamma < 0){\n\t\t\t        rotation3d.x = -90 - event.gamma;\n\t\t\t        rotation3d.y = -event.alpha;\n\t\t\t    }else{\n\t\t\t    \trotation3d.x = 90 - event.gamma;\n\t\t\t    \trotation3d.y = 180 - event.alpha;\n\t\t\t    }\n\t\t    }else if(realOrientation == -90){\n\t\t        if(event.gamma < 0){\n\t\t\t        rotation3d.x = 90 + event.gamma;\n\t\t\t        rotation3d.y = -event.alpha;\n\t\t\t    }else{\n\t\t\t    \trotation3d.x = -90 + event.gamma;\n\t\t\t    \trotation3d.y = 180 - event.alpha;\n\t\t\t    }\n\t\t    }else if(realOrientation == 0){\n\t\t    \trotation3d.x = event.beta - 90;\n\t\t    \tif(verticalY != null){\n\t\t    \t\tvar newY = 180 - event.alpha\n\t\t    \t\tif(Math.abs(verticalY-newY)<10){\n\t\t    \t\t\trotation3d.y = 180 - event.alpha;\n\t\t    \t\t}\n\t\t    \t}\n\t\t    \tverticalY = 180 - event.alpha;\n\t\t    }else{\n\t\t    \trotation3d.x = event.beta - 90;\n\t\t    \trotation3d.y = 180 - event.alpha;\n\t\t    }\n\t\t    if(realOrientation != window.orientation){\n\t\t    \trotation3d.y = 180 + rotation3d.y;\n\t\t    }\n\t\t    if(intialRotation==null){\n\t\t\t\tintialRotation = rotation3d.y;\n\t\t\t}\n\t    }\n\t}\n\n\tvar lastTouchX,lastTouchY = null;\n\tvar xShift = 0;\n\tvar yShift = 0;\n\n\n\tdocument.body.addEventListener('touchstart', function(e){\n        lastTouchX = e.changedTouches[0].pageX;\n        lastTouchY = e.changedTouches[0].pageY;\n    }, false)\n\tdocument.body.addEventListener('touchmove', function(e){\n\t\tif(lastTouchX != null){\n\t\t\tvar deltaX = (e.changedTouches[0].pageX-lastTouchX);\n\t\t\tyShift += deltaX/5;\n\t\t\tlastTouchX = e.changedTouches[0].pageX;\n\t\t}\n\t\tif(lastTouchY != null){\n\t\t\tvar deltaY = (e.changedTouches[0].pageY-lastTouchY);\n\t\t\txShift -= deltaY/5;\n\t\t\tif(rotation3d.x + xShift > 45) xShift = 45 - rotation3d.x;\n\t\t\tif(rotation3d.x + xShift < -45) xShift = - rotation3d.x - 45;\n\t\t\tlastTouchY = e.changedTouches[0].pageY;\n\t\t}\n    }, false)\n\n\tdocument.body.addEventListener('touchend', function(e){\n\t\tlastTouchX = null;\n\t\tlastTouchY = null;\n\t}, false)\n\n\n\n\tfunction refresh(){\n\t\tif(cubeManager.enabled){\n\t\t\t//var smooth = 0.1;\n\t\t\tvar smooth = 0;\n\t\t\tvar newX,newY;\n\t\t\tif(lastX && lastX){\n\t\t\t\tif(Math.abs(lastX - rotation3d.x) < 90 && Math.abs(lastY - rotation3d.y-intialRotation) < 90){\n\t\t\t\t\tnewX = smooth*lastX + (1-smooth)*rotation3d.x;\n\t\t\t\t\tnewY = smooth*lastY + (1-smooth)*rotation3d.y-intialRotation;\n\t\t\t\t}else{\n\t\t\t\t\tnewX = rotation3d.x;\n\t\t\t\t\tnewY = rotation3d.y-intialRotation;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tnewX = rotation3d.x;\n\t\t\t\tnewY = rotation3d.y-intialRotation;\n\t\t\t}\n\n\t\t\tlastX = newX;\n\t\t\tlastY = newY;\n\n\t\t\tnewX += xShift;\n\t\t\tnewY += yShift;\n\n\t\t\tif(!isie()){\n\t\t\t\tvar newOrientation;\n\t\t\t\tif($(window).width() > 2000){\n\t\t\t\t\tnewOrientation = \"translate3d(0px,0px,1250px) rotateX(\" + newX + \"deg) rotateY(\" + newY + \"deg)\";\n\t\t\t\t}else if($(window).width() > 1280){\n\t\t\t\t\tnewOrientation = \"translate3d(0px,0px,1000px) rotateX(\" + newX + \"deg) rotateY(\" + newY + \"deg)\";\n\t\t\t\t}else{\n\t\t\t\t\tnewOrientation = \"translate3d(0px,0px,640px) rotateX(\" + newX + \"deg) rotateY(\" + newY + \"deg)\";\n\t\t\t\t}\n\t\t\t\t$('#'+cubeManager.cubeName+' .cube').css({\n\t\t\t        'transform': newOrientation,\n\t\t\t        '-webkit-transform': newOrientation,\n\t\t\t        '-moz-transform': newOrientation,\n\t\t\t        '-ms-transform': newOrientation,\n\t\t\t        '-o-transform:rotate': newOrientation\n\t\t\t    });\n\t\t\t}else{\n\t\t\t\twindow.tourManager.setIePosition(newX,newY);\n\t\t\t}\n\t\t}\n\t}\n\twindow.setInterval(refresh,40);\n});\n"]}