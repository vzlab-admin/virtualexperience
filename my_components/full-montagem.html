<link rel="import" href="../bower_components/polymer/polymer.html" />
<link rel="import" href="../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="info-bar.html">
<link rel="import" href="vz-slider.html" />
<link rel="import" href="exit-button.html">

<dom-module id="full-montagem">
    <style>
        :host{
            display:none;
            opacity:0;
            position:absolute;
            width:100%;
            height:100%;
            top:0px;
            left:0px;
            
            background-image: url(/assets/montagem.jpg);
            background-size:cover;
            background-repeat:no-repeat;
            background-position: center center;
            background-repeat: no-repeat;
            transition:opacity .5s ease-in-out;
        }
        
        :host.ativo{
            opacity:1;
        }
        
        .meio{
            position:absolute;
            display:block;
            width:100%;
            height:100%;
            top:0px;
            left:0px;
        }
        
        .meio .dentro{
            position:absolute;
            display:block;
            top:0px;
            left:0px;
            width:100%;
            height:100%;
            
            background-position: center center;
            background-size:cover;
            background-repeat: no-repeat;
        }
        
        .meio #freio{
            background-image: url(/assets/montagem_freio.png);
            
        }
        
        .meio #disco{
            background-image: url(/assets/montagem_disco.png);
        }

    </style>
    
    
   <template>
        <vz-slider id="slider" on-slide="slideUpdate"></vz-slider>
        <div id="container" class="container">
            <div class="meio">
                <div id="freio" class="dentro"></div>
                <div id="disco" class="dentro"></div>
            </div>
        </div>
        <info-bar id="info">
            <content select=".infoBar" class="infoBar"></content>
        </info-bar>
        <exit-button  on-tap="hide"></exit-button>
        
        
        
   </template>
    
</dom-module>

<script>
    Polymer({
        is: "full-montagem",
        
        behaviors: [
          Polymer.IronResizableBehavior
        ],
    
        properties: {
            
        },
        
        listeners: {
          'iron-resize': 'meuResize'
        },
        
        meuResize:function(){
            this.slideUpdate({detail:{value:this.$.slider.value}});
        },
        
        hide:function(){
            if(this.style.display=="block"){
                this.classList.remove("ativo");
                
                this.async(function(){
                    this.style.display="none";
                    this.$.info.classList.remove("ativo")
                },500)
            }
        },
        
        show:function(){
            this.$.slider.value=0;
            if(this.classList.contains("ativo")==false){
                this.style.display="block";
                
                this.async(function(){
                    this.classList.add("ativo");
                },100)
                
            }
            
            // this.slideUpdate({detail:{value:this.$.slider.value}});
        },
        
        ready:function(){

        },
        
        slideUpdate:function(e){
            var valor=parseFloat(e.detail.value)/100;

            var myRation=this.clientWidth/this.clientHeight;
            var bgRatio=1926/1080;
            
            if(myRation<bgRatio){
                this.$.disco.style.backgroundPositionX="calc(50% - " + ((168/1080)*this.clientHeight*valor) +"px)"
                this.$.disco.style.backgroundPositionY="calc(50% - " + ((8/1080)*this.clientHeight*valor) +"px)"
                
                this.$.freio.style.backgroundPositionX="calc(50% - " + ((397/1080)*this.clientHeight*valor) +"px)"
                this.$.freio.style.backgroundPositionY="calc(50% - " + ((18/1080)*this.clientHeight*valor) +"px)"
            }else{
                this.$.disco.style.backgroundPositionX="calc(50% - " + ((168/1926)*this.clientWidth*valor) +"px)"
                this.$.disco.style.backgroundPositionY="calc(50% - " + ((8/1926)*this.clientWidth*valor) +"px)"
                
                this.$.freio.style.backgroundPositionX="calc(50% - " + ((397/1926)*this.clientWidth*valor) +"px)"
                this.$.freio.style.backgroundPositionY="calc(50% - " + ((18/1926)*this.clientWidth*valor) +"px)"
            }
        },
    });
</script>